"use strict";!function(e){function t(t){e(".autoprompt li").removeClass("hover").eq(t).addClass("hover")}if("undefined"==typeof e)throw new Error("Autoprompt requires jQuery!");!function(){String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.prototype.filter||(Array.prototype.filter=function(e){var t=this.length;if("function"!=typeof e)throw new TypeError;for(var i=[],n=arguments[1],o=0;t>o;o++)if(o in this){var s=this[o];e.call(n,s,o,this)&&i.push(s)}return i})}();var i={minLength:1,itemLength:8,timeout:100,appendTo:"body"},n=function(e,t,i){this.$elem=e,this.init(t,i)};e.fn.autoprompt=function(t,i){return new n(e(this),t,i)},n.prototype={init:function(t,n){this.opts=e.extend({},i,n),this.$appendTo=e(this.opts.appendTo),this.src=t,this.css="position: absolute;z-index: 99999;top: "+(this.$elem.offset().top+this.$elem.height()+2*parseInt(this.$elem.css("paddingTop"))-this.$appendTo.offset().top)+"px;left: "+(this.$elem.offset().left-this.$appendTo.offset().left)+"px;width: "+(this.$elem.width()+parseInt(this.$elem.css("paddingLeft"))+parseInt(this.$elem.css("paddingRight"))+2)+"px;",this.index=-1,this.getData(this.src),this.create(),this.changeListener()},create:function(){this.$appendTo.css("position","relative").append('<div class="autoprompt" style="'+this.css+'display: none;"><ul></ul></div>'),this.$autoprompt=e(".autoprompt")},render:function(e){for(var t="",i=e.length>this.opts.itemLength?this.opts.itemLength:e.length,n=0;i>n;n++)t+='<li data-model="'+e[n].value+'">'+e[n].value+"</li>";""===t?this.clean():this.$autoprompt.css("display","block").find("ul").empty().append(""+t),this.removeEvent(),this.bindEvent(i)},clean:function(){this.$autoprompt.css("display","none")},filter:function(e){var t=[];if(!e)return void this.clean();if(t=this.data.filter(function(t){return t.value.toLowerCase().includes(e)}),0===t.length){var e=e.match(/\d+/);if(!e)return;t=this.data.filter(function(t){return t.value.includes(e)})}this.render(t)},getData:function(t){var i=this;"string"==typeof t&&t.length>0&&e.ajax({url:t,type:"get",dataType:"json",success:function(e){i.data=e}})},changeListener:function(){var t=this,i=navigator.userAgent.toLowerCase();i.includes("ie 8.0")||i.includes("ie 9.0")?t.$elem.on("keyup",function(){var i=e(this).val().toLowerCase();t.index=-1,t.filter(i)}):t.$elem.on("input",function(){var i=e(this).val().toLowerCase();t.index=-1,t.filter(i)})},bindEvent:function(i){var n=this,o=this,s=navigator.userAgent.toLowerCase();s.includes("ie 8.0")||s.includes("ie 9.0")?o.$elem.on("keydown keyup",function(n){switch(n.keyCode){case 40:"keydown"===n.type?n.preventDefault():"keyup"===n.type&&(o.index=o.index===i-1?0:o.index+1,t(o.index));break;case 38:"keydown"===n.type?n.preventDefault():"keyup"===n.type&&(o.index=0===o.index?i-1:o.index-1,t(o.index));break;case 13:if("keydown"===n.type)"none"!==o.$autoprompt.css("display")&&n.preventDefault();else if("keyup"===n.type&&"none"!==o.$autoprompt.css("display")){n.preventDefault();var s=e(".autoprompt li:eq("+o.index+")").data("model");e(this).val(s),o.$autoprompt.css("display","none")}}}):o.$elem.on("keydown",function(n){switch(n.keyCode){case 40:n.preventDefault(),o.index=o.index===i-1?0:o.index+1,t(o.index);break;case 38:n.preventDefault(),o.index=0===o.index?i-1:o.index-1,t(o.index);break;case 13:if("none"!==o.$autoprompt.css("display")){n.preventDefault();var s=e(".autoprompt li:eq("+o.index+")").data("model");e(this).val(s),o.$autoprompt.css("display","none")}}}),o.$autoprompt.on("click","li",function(){var t=e(n).data("model");o.$elem.val(t),o.$autoprompt.css("display","none")}).on("hover","li",function(){e(".autoprompt li").removeClass("hover"),e(this).addClass("hover"),o.index=e(this).index()})},removeEvent:function(){this.$elem.off("keyup"),this.$elem.off("keydown")}}}(jQuery);